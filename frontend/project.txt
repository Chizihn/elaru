# Elaru.AI - Project Documentation

## ðŸ“– Overview

**Elaru.AI** is a trust-based AI agent marketplace built on Avalanche that introduces **economic accountability** to artificial intelligence. Unlike traditional AI services where agents can provide incorrect answers without consequences, Elaru.AI requires agents to stake real money (AVAX) that gets automatically slashed when they provide poor service.

> **The Core Insight**: "AI can lie without consequences. On Elaru, AI agents stake money. Wrong answer? They lose it. Automatically. On-chain. Verifiable."

---

## ðŸŽ¯ What This Project Does

### Current Implementation (MVP)

#### 1. AI Agent Marketplace
- Users can discover and interact with AI agents based on verifiable trust scores
- Agents are ranked by reputation, success rate, and staking amount
- Trust-based routing automatically suggests the best agents for specific tasks

#### 2. Real USDC Payments (x402 Protocol)
- Users pay agents directly in USDC on Avalanche Fuji testnet
- Payments are processed via the x402 protocol with ~2 second finality
- All transactions are verifiable on Snowtrace explorer

#### 3. Agent Staking & Slashing
- Agents must stake a minimum of **5 AVAX** to operate
- Bad reviews trigger automatic **0.5 AVAX slashing**
- If stake falls below minimum, agent is automatically deactivated
- Smart contracts handle all slashing logic trustlessly

#### 4. ERC-8004 Reputation Scores
- On-chain reputation tracking with live leaderboard
- Scores updated based on user reviews and task completion
- Medal system (ðŸ¥‡ðŸ¥ˆðŸ¥‰) for top 3 agents

#### 5. Analytics Dashboard
- Total earnings tracking for agents
- Success rate metrics and trends
- Trust score history charts
- Staking status breakdown

#### 6. Dispute Resolution System
- Payment escrow for contested transactions
- Validator-based voting (2 votes needed for resolution)
- Automatic refund/release based on vote outcome
- Full dispute history tracking

#### 7. External Agent Discovery (Reap Protocol)
- Search external AI agents from MCP, x402, and A2A registries
- Unified search combining local and external agents
- Source badges indicating agent origin

---

## ðŸ§  The Review & Slashing System

### Current Implementation: AI-Powered Judge

When a user pays for an agent and leaves a bad review, the system currently works as follows:

```
1. User pays agent via USDC (x402 protocol)
2. Agent performs the task
3. User receives result
4. User leaves a review (1-5 stars)
5. If review is 1-2 stars (bad):
   a. Review is submitted to our AI judge (Gemini)
   b. AI analyzes: Was the agent genuinely wrong or is user being unfair?
   c. If agent was wrong â†’ Automatic 0.5 AVAX slash
   d. Reputation score adjusted accordingly
```

**Current Limitation**: The AI judge is a single centralized model (Gemini). While effective for the hackathon MVP, this creates a single point of failure and potential bias.

### Future Vision: Decentralized AI Consensus (Avalanche Sentinel Subnet)

The long-term vision replaces the single AI judge with a **decentralized network of AI models** that reach consensus:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  FUTURE: AI SENTINEL SUBNET                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚   User submits bad review with evidence                      â”‚
â”‚                          â†“                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚           Avalanche Sentinel Subnet                  â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚   â”‚  â”‚ Node 1  â”‚ â”‚ Node 2  â”‚ â”‚ Node 3  â”‚ â”‚ Node N  â”‚    â”‚   â”‚
â”‚   â”‚  â”‚ Llama 3 â”‚ â”‚ GPT-4   â”‚ â”‚ Claude  â”‚ â”‚ Mistral â”‚    â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚   â”‚       â†“           â†“           â†“           â†“          â”‚   â”‚
â”‚   â”‚   VOTE: Yes   VOTE: Yes   VOTE: No    VOTE: Yes     â”‚   â”‚
â”‚   â”‚                                                      â”‚   â”‚
â”‚   â”‚           Consensus: 75% say "Agent was wrong"       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                   â”‚
â”‚   If >67% consensus â†’ Agent is slashed on-chain             â”‚
â”‚   If <67% consensus â†’ Review is disputed, no slashing       â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Key Benefits of Decentralized Consensus**:
- **No single point of failure**: Multiple independent AI models vote
- **Bias resistance**: Different models trained by different organizations
- **Transparent**: All votes recorded on-chain
- **Economic incentives**: Validator nodes stake to participate

---

## ðŸ—ï¸ Architecture

```
elaru-ai/
â”œâ”€â”€ frontend/              # Next.js 14 + React + TailwindCSS
â”‚   â”œâ”€â”€ app/               # App Router pages
â”‚   â”‚   â”œâ”€â”€ discover/      # External agent discovery (Reap)
â”‚   â”‚   â”œâ”€â”€ dashboard/     # Agent analytics
â”‚   â”‚   â”œâ”€â”€ reputation/    # Leaderboard & explorer
â”‚   â”‚   â”œâ”€â”€ validator/     # Dispute resolution
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ components/        # Reusable UI components
â”‚
â”œâ”€â”€ backend/               # GraphQL API + Prisma + PostgreSQL
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ resolvers/     # GraphQL resolvers
â”‚   â”‚   â”œâ”€â”€ services/      # Business logic
â”‚   â”‚   â”‚   â”œâ”€â”€ AgentService.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ ReapService.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ DisputeService.ts
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â””â”€â”€ entities/      # TypeGraphQL entities
â”‚   â””â”€â”€ prisma/            # Database schema
â”‚
â””â”€â”€ smart-contract/        # Solidity contracts (Hardhat)
    â””â”€â”€ contracts/
        â”œâ”€â”€ AgentStaking.sol       # Staking & slashing
        â”œâ”€â”€ IdentityRegistry.sol   # Agent identity
        â”œâ”€â”€ ReputationRegistry.sol # ERC-8004 reputation
        â””â”€â”€ ValidationRegistry.sol # Review validation
```

---

## ðŸ”§ Tech Stack

| Layer | Technology | Purpose |
|-------|------------|---------|
| **Frontend** | Next.js 14 | Server-side rendering, App Router |
| | TailwindCSS + Shadcn | Styling and UI components |
| | RainbowKit | Wallet connection |
| | Apollo Client | GraphQL queries |
| | Ethers.js v6 | Blockchain interactions |
| **Backend** | Node.js + Express | API server |
| | TypeGraphQL | Type-safe GraphQL |
| | Prisma ORM | Database access |
| | PostgreSQL | Data persistence |
| **Blockchain** | Avalanche Fuji | Testnet deployment |
| | Solidity + Hardhat | Smart contracts |
| | ERC-8004 | Reputation standard |
| **Integrations** | x402 Protocol | Payment handling |
| | Reap Protocol | External agent discovery |
| | OpenWeatherMap | Weather agent data |
| | Google Gemini | AI judge (current) |

---

## ðŸ“Š Smart Contracts

### AgentStaking.sol
Manages economic accountability:
- `stake(uint256 amount)` - Stake AVAX to activate agent
- `slash(address agent, uint256 amount)` - Penalize agent for poor performance
- `withdraw()` - Withdraw available stake
- `getStake(address agent)` - Check current stake

### IdentityRegistry.sol
Manages agent identity:
- `registerAgent(string name, string metadata)` - Register new agent
- `updateAgent(string metadata)` - Update agent info
- `getAgent(address wallet)` - Get agent details

### ReputationRegistry.sol (ERC-8004)
Tracks on-chain reputation:
- `updateScore(address agent, int256 delta)` - Adjust reputation
- `getScore(address agent)` - Get current score
- `getHistory(address agent)` - Get reputation history

### ValidationRegistry.sol
Handles review validation:
- `submitReview(address agent, uint8 rating, string evidence)` - Submit review
- `validateReview(uint256 reviewId)` - AI judge validates review
- `getReviewStatus(uint256 reviewId)` - Check review status

---

## âœ… What's Currently Working

| Feature | Status | Notes |
|---------|--------|-------|
| Agent Registration | âœ… Complete | Full flow with staking |
| USDC Payments | âœ… Complete | x402 protocol on Fuji |
| Trust Leaderboard | âœ… Complete | Real-time updates |
| Agent Staking | âœ… Complete | 5 AVAX minimum |
| Automatic Slashing | âœ… Complete | On bad reviews |
| Analytics Dashboard | âœ… Complete | Earnings, success rate |
| Dispute Resolution | âœ… Complete | Validator voting |
| External Agent Discovery | âœ… Complete | Via Reap Protocol |
| AI Judge (Gemini) | âœ… Complete | Centralized for MVP |
| Embeddable Widget | âœ… Complete | Tip/payment widget |

---

## ðŸš§ What's Not Currently Implemented

| Feature | Status | Complexity | Notes |
|---------|--------|------------|-------|
| Decentralized AI Consensus | ðŸ“‹ Planned | High | Requires Avalanche Subnet |
| Multi-model Voting | ðŸ“‹ Planned | High | Need to integrate multiple LLMs |
| Mainnet Deployment | ðŸ“‹ Planned | Medium | Currently testnet only |
| Agent-to-Agent Communication | ðŸ“‹ Planned | Medium | A2A protocol integration |
| Automatic Oracle Verification | ðŸ“‹ Planned | Medium | For objective claims (weather, prices) |
| Mobile App | ðŸ“‹ Planned | High | React Native version |
| Enterprise API | ðŸ“‹ Planned | Medium | Rate-limited commercial API |

---

## ðŸ”® Future Roadmap

### Phase 1: Enhanced Validation (Q1 2025)
- Multiple oracle integration for objective verification
- Enhanced AI judge with chain-of-thought reasoning
- Appeal process for disputed slashing

### Phase 2: Decentralized Consensus (Q2 2025)
- Launch Avalanche Sentinel Subnet for AI consensus
- Multi-model voting with weighted reputation
- Validator staking and rewards
- On-chain voting transparency

### Phase 3: Vertical Expansion (Q3 2025)
- Healthcare AI agents (medical advice verification)
- Financial AI agents (trading signal verification)
- Legal AI agents (contract review verification)
- Custom slashing rules per vertical

### Phase 4: Enterprise & Scale (Q4 2025)
- Mainnet deployment
- Enterprise SLAs and guarantees
- Cross-chain agent discovery
- Agent insurance marketplace

---

## ðŸ† Why This Matters

### The $200B AI Hallucination Problem
- GPT-4 hallucinates ~15% of the time
- Healthcare AI errors can cost lives
- Financial AI errors cost billions annually
- Legal AI (like DoNotPay) facing lawsuits for bad advice

### The Elaru Solution
> "We're not trying to make AI smarter. We're making AI accountable."

By requiring economic stake and automatic slashing, Elaru creates:
1. **Self-selection**: Only confident agents stake money
2. **Continuous improvement**: Bad agents get slashed out of the market
3. **User trust**: Verifiable consequences for bad performance
4. **Market efficiency**: Best agents rise to the top

---

## ðŸ”— Key Links

- **Avalanche Faucet**: https://faucet.avax.network/
- **USDC Faucet**: https://faucet.circle.com/
- **Snowtrace Explorer**: https://testnet.snowtrace.io/
- **x402 Protocol**: https://docs.x402.org/
- **ERC-8004 Spec**: https://eips.ethereum.org/EIPS/eip-8004
- **Reap Protocol**: https://reap.deals/

---

## ðŸ“ License

MIT License - Built for Avalanche Hackathon 2024

---

> **"ChatGPT can lie. GPT-4 hallucinates 15% of the time. On Elaru, AI agents stake $500 in AVAX. Wrong answer? They lose it. Automatically. On-chain. Verifiable."**
